using HtmlAgilityPack;
using MGOBankApp.Models;

namespace MGOBankApp.BLL.Interfaces
{
    public interface IVulnerabilityAnalyzer
    {
        Task<List<string>> FindLoginPages(string baseUrl);
        bool CsrfTest(string method, HtmlNode form);
        Task<bool> BrokenAuthenticationTest(string loginUrl);
        Task<bool> SqlInjectionTest(string baseUrl);
        Task<bool> XssTest(string method, string absoluteAction, Dictionary<string, string> data);
        Task<bool> SecurityMisconfigurationTest(string url);
        Task<bool> UnvalidatedRedirectTest(string url);
        Task<bool> DirectoryListingTest(string url);
        Task<bool> IdorTest(string url);
        Task<bool> RfiTest(string url);
        Task<bool> LfiTest(string url);
        Task<bool> HttpResponseSplittingTest(string url);
        Task<bool> PhishingTest(string url);
        Task<(string response, int statusCode)> SendRequest(string method, string action, Dictionary<string, string> data);
        bool IsHttp(Uri baseUri);
        int CalculateVulnerabilityCount(Vulnerability vulnerability);
        // Add port scanning method
        Task<Dictionary<int, (bool IsOpen, string Service, string Version)>> ScanPorts(string host);
    }
}

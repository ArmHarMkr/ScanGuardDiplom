using HtmlAgilityPack;
using MGOBankApp.Models;

namespace MGOBankApp.BLL.Interfaces
{
    public interface IVulnerabilityAnalyzer
    {
        public Task<List<string>> FindLoginPages(string baseUrl);
        public Task<bool> BrokenAuthenticationTest(string loginUrl);
        public bool CsrfTest(string method, HtmlNode form);
        public Task<bool> SqlInjectionTest(Dictionary<string, string> data, string method, string absoluteAction);
        public Task<bool> XssTest(string method, string absoluteAction, Dictionary<string, string> data); 
        public Task<(string response, int statusCode)> SendRequest(string method, string action, Dictionary<string, string> data);
        public bool IsHttp(Uri baseUri);
        public Task<bool> IdorTest(string url);
        public Task<bool> SecurityMisconfigurationTest(string url);
        public Task<bool> UnvalidatedRedirectTest(string url);
        public Task<bool> DirectoryListingTest(string url);
        public Task<bool> RfiTest(string url);
        public Task<bool> LfiTest(string url);
        public Task<bool> HttpResponseSplittingTest(string url);
        public Task<bool> PhishingTest(string url);
        public int CalculateVulnerabilityCount(Vulnerability vulnerability);
    }
}
